/** ************************************************************************* * Copyright (c) 2000: * University of Alberta, * Deptartment of Computing Science * Computer Poker Research Group * * See "Liscence.txt" ************************************************************************** */package org.alberta.poker.ai.model;import java.util.*;import org.alberta.poker.Holdem;import org.alberta.poker.ai.Context;import org.alberta.poker.util.Reporter;public class Evaluator {    private double decay = 0.95;    public Evaluator() {    }    public Evaluator(double decay) {        this.decay = decay;    }    public double estimateAccuracy(Vector test_data, Predictor pdr) {        double correct = 0;        double decCount = 0;        double curDecay = this.decay;        for (int i = 0; i < test_data.size(); i++) {            Context c = (Context) test_data.elementAt(i);            if (c != null) {                if (c.getStage() != Holdem.PREFLOP) {                    if (pdr.predictAction(c).selectMax() == c.getAction()) {                        correct += curDecay;                    }                    decCount += curDecay;                    curDecay *= decay;                }            }        }        if (decCount == 0) {            return 0;        }        return Reporter.round(100.0 * ((double) correct / (double) decCount), 1);    }    /**     * Perform an analysis of the predictor.     */    public void confusion(Vector test_data, Predictor pdr) {        double sm[][] = new double[3][3];        for (int i = 0; i < test_data.size(); i++) {            Context c = (Context) test_data.elementAt(i);            int action = pdr.predictAction(c).selectMax();            sm[c.getAction()][action]++;        }        System.out.println("     ------ PREDICTED ------          ");        System.out.println("+---+-------+-------+-------+ +-------+");        System.out.println("| * |   F   |   C   |   R   | | FREQ  |");        System.out.println("+---+-------+-------+-------+ +-------+");        for (int k = 0; k < 3; k++) {            System.out.print("| " + (k == 0 ? "F" : (k == 1 ? "C" : "R")) + " |");            for (int j = 0; j < 3; j++) {                System.out.print(Reporter.pad(" " + Reporter.round(sm[k][j] / test_data.size(), 3), 7) + "|");            }            System.out.println(" |" + Reporter.pad(" " + Reporter.round(100 * ((sm[k][0] + sm[k][1] + sm[k][2]) / test_data.size()), 1) + "%", 7) + "|");            System.out.println("+---+-------+-------+-------+ +-------+");        }        System.out.println("+---+-------+-------+-------+ +-------+");        System.out.print("| % |");        for (int k = 0; k < 3; k++) {            System.out.print(Reporter.pad(" " + Reporter.round(100 * ((sm[0][k] + sm[1][k] + sm[2][k]) / test_data.size()), 1) + "%", 7) + "|");        }        System.out.println(" |" + Reporter.pad(" " + Reporter.round(100 * ((sm[0][0] + sm[1][1] + sm[2][2]) / test_data.size()), 2), 7) + "|");        System.out.println("+---+-------+-------+-------+ +-------+");    }}